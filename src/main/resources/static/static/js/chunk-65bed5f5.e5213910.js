(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65bed5f5"],{"1ce3":function(e,a,o){},"364f":function(e,a,o){},"5f3a":function(e,a,o){"use strict";var r=o("364f"),s=o.n(r);s.a},"74c9":function(e,a,o){"use strict";var r=o("1ce3"),s=o.n(r);s.a},"8a21":function(e,a,o){"use strict";o.r(a);var r=function(){var e=this,a=e.$createElement,o=e._self._c||a;return o("el-card",[o("el-tabs",{model:{value:e.activeName,callback:function(a){e.activeName=a},expression:"activeName"}},[o("el-tab-pane",{attrs:{name:"getbackHome"}},[o("span",{attrs:{slot:"label"},slot:"label"},[o("router-link",{attrs:{to:{path:"/"}}},[o("i",{staticClass:"iconfont icon-angle-left"}),e._v("返回首页")])],1)]),o("el-tab-pane",{attrs:{label:"个人资料",name:"profile"}}),o("el-tab-pane",{attrs:{label:"账号设置",name:"account"}})],1),"profile"==e.activeName?[o("el-form",{ref:"profileForm",attrs:{model:e.profileForm,rules:e.profileRules,"label-width":"80px","label-position":"right"}},[o("el-form-item",{attrs:{label:"头像"}},[o("el-upload",{staticClass:"avatar-uploader",attrs:{action:"",headers:e.myHeaders,"auto-upload":!1,"show-file-list":!1,"on-change":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?o("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):o("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("仅支持上传jpg文件，图片大小不超过500KB")])])],1),o("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[o("el-input",{model:{value:e.profileForm.userName,callback:function(a){e.$set(e.profileForm,"userName",a)},expression:"profileForm.userName"}})],1),o("el-form-item",{attrs:{label:"昵称",prop:"userNickName"}},[o("el-input",{model:{value:e.profileForm.userNickName,callback:function(a){e.$set(e.profileForm,"userNickName",a)},expression:"profileForm.userNickName"}})],1),o("el-form-item",{attrs:{label:"邮箱",prop:"userEmail"}},[o("el-input",{model:{value:e.profileForm.userEmail,callback:function(a){e.$set(e.profileForm,"userEmail",a)},expression:"profileForm.userEmail"}})],1),o("el-form-item",{attrs:{label:"手机号码",prop:"userPhone"}},[o("el-input",{model:{value:e.profileForm.userPhone,callback:function(a){e.$set(e.profileForm,"userPhone",a)},expression:"profileForm.userPhone"}})],1),o("div",{staticStyle:{"text-align":"center"}},[o("el-button",{attrs:{loading:e.profileLoading,type:"primary"},on:{click:e.submitProfileForm}},[e._v("更 新")])],1)],1)]:"account"==e.activeName?[o("el-button",{attrs:{type:"text"},on:{click:function(a){e.accountDialogVisible=!0}}},[e._v("修改密码")]),o("el-dialog",{attrs:{title:"修改密码",visible:e.accountDialogVisible,width:"50%",center:"","close-on-click-modal":!1},on:{"update:visible":function(a){e.accountDialogVisible=a}}},[o("el-form",{ref:"accountForm",attrs:{model:e.accountForm,rules:e.accountRules}},[o("el-form-item",{attrs:{label:"原密码：",prop:"oldPassWd"}},[o("el-input",{attrs:{"show-password":""},model:{value:e.accountForm.oldPassWd,callback:function(a){e.$set(e.accountForm,"oldPassWd",a)},expression:"accountForm.oldPassWd"}})],1),o("el-form-item",{attrs:{label:"新密码：",prop:"newPassWd"}},[o("el-input",{attrs:{"show-password":""},model:{value:e.accountForm.newPassWd,callback:function(a){e.$set(e.accountForm,"newPassWd",a)},expression:"accountForm.newPassWd"}})],1),o("el-form-item",{attrs:{label:"请再次输入新密码：",prop:"sameNewPassWd"}},[o("el-input",{attrs:{"show-password":""},model:{value:e.accountForm.sameNewPassWd,callback:function(a){e.$set(e.accountForm,"sameNewPassWd",a)},expression:"accountForm.sameNewPassWd"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(a){e.accountDialogVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{loading:e.accountLoading,type:"primary"},on:{click:e.submitAccountForm}},[e._v("提 交")])],1)],1)]:e._e()],2)},s=[],t=(o("b0c0"),o("d3b7"),o("3ca3"),o("ddb0"),o("2b3d"),o("8237")),i=o.n(t),l={data:function(){var e=this,a=function(a,o,r){o!==e.accountForm.newPassWd?r(new Error("两次输入密码不一致")):r()};return{myHeaders:{"Access-Control-Allow-Origin":"*"},userAvatar:"",activeName:"profile",imageUrl:"",avatarDialogVisible:!1,accountDialogVisible:!1,accountLoading:!1,profileLoading:!1,profileForm:{userName:"",userNickName:"",userEmail:"",userPhone:""},accountForm:{oldPassWd:"",newPassWd:"",sameNewPassWd:""},profileRules:{userName:[{required:!0,message:"用户名不能为空",trigger:"blur"},{min:3,max:20,message:"长度为3-20个字符",trigger:"blur"}],userPhone:[{required:!0,message:"手机号不能为空",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确"}],userEmail:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{pattern:/^[A-Za-z0-9-_\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,message:"邮箱格式不正确"}]},accountRules:{oldPassWd:[{required:!0,message:"原密码不能为空",trigger:"blur"}],newPassWd:[{required:!0,message:"密码不能为空",trigger:"blur"},{pattern:/^(\w){5,15}$/,message:"只能输入字母、数字、下划线，长度为5-15个字符"}],sameNewPassWd:[{required:!0,validator:a,trigger:"blur"}]}}},created:function(){this.getUserInfo()},methods:{submitProfileForm:function(){var e=this;this.$refs.profileForm.validate((function(a){if(a){e.profileLoading=!0;var o="profile",r=new FormData;for(var s in e.profileForm)r.append(s,e.profileForm[s]);r.append("type",o),r.append("userAvatar",e.userAvatar),r.append("oldUserName",e.$store.state.user.name),e.$store.dispatch("user/modifyUserInfo",r).then((function(a){e.profileLoading=!1,e.$store.state.user.name=a.userName,e.$message.success({message:"更新成功",showClose:!0}),location.reload()})).catch((function(a){e.profileLoading=!1,console.log(a)}))}}))},submitAccountForm:function(){var e=this;this.$refs.accountForm.validate((function(a){if(a){e.accountLoading=!0;var o="account",r=new FormData;r.append("oldPassWd",i()(e.accountForm.oldPassWd)),r.append("newPassWd",i()(e.accountForm.newPassWd)),r.append("userName",e.$store.state.user.name),r.append("type",o),e.$store.dispatch("user/modifyUserInfo",r).then((function(a){e.accountLoading=!1,e.accountDialogVisible=!1,e.$message.success({message:"更新成功",showClose:!0}),location.reload()})).catch((function(a){e.accountLoading=!1,console.log(a)}))}}))},handleAvatarSuccess:function(e,a){this.imageUrl=URL.createObjectURL(e.raw),console.log("imgurl:",this.imageUrl),this.userAvatar=e.raw},beforeAvatarUpload:function(e){var a="image/jpeg"===e.type,o=e.size/1024<500;return a||this.$message.error("上传头像图片只能是 JPG 格式!"),o||this.$message.error("上传头像图片大小不能超过 500KB!"),a&&o},getUserInfo:function(){var e=this;this.$store.dispatch("user/getUserInfo").then((function(a){e.imageUrl=a.userInfo.userAvatarPath,e.profileForm.userName=a.userInfo.userName,e.profileForm.userNickName=a.userInfo.userNickName,e.profileForm.userEmail=a.userInfo.userEmail,e.profileForm.userPhone=a.userInfo.userPhone}))}}},n=l,c=(o("5f3a"),o("74c9"),o("2877")),u=Object(c["a"])(n,r,s,!1,null,"52704d0e",null);a["default"]=u.exports}}]);